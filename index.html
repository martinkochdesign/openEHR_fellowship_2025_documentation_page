<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fellowship Updates</title>
  <style>
    body {
      margin: 0;
      /*font-family: Arial, sans-serif;*/
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
      line-height: 160%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }

    header {
      color: #258BB0;
      background-color: white;
      padding-right: 1em;
      padding-left: 1em;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      margin: 0;
    }

    h1, h2, h3{
      color: #258BB0;
    }

    strong{
      color: #FF861C;
    }

    button{
        border-radius: 5px;
    }

    #aboutButton {
      background-color: #FF861C;
      color: white;
      border: none;
      padding: 0.5em 1em;
      cursor: pointer;
    }

    td,th{
      font-size: 10pt;
    }

    li{
      /*font-size: 10pt;^*/
  
    }

    main {
      flex: 1;
      display: flex;
      height: calc(100% - 300px);
    }

    .sidebar {
      width: 15%;
      overflow-y: auto;
      background-color: #f0f0f0;
      padding: 1em;
    }

    .content {
      flex: 1;
      overflow-y: auto;
      padding: 1em;
    }

    .sidebar h2 {
      color: #258BB0;
    }

    .item {
      cursor: pointer;
      padding: 0.5em;
      border-bottom: 1px solid #ccc;
    }

    .item:hover {
      background-color: #e0e0e0;
    }

    video {
      max-width: 100%;
      height: auto;
    }

    #aboutOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      color: white;
      padding: 2em;
      box-sizing: border-box;
    }

    #aboutContent {
      background-color: #258BB0;
      padding: 2em;
      max-width: 600px;
      border-radius: 10px;
      position: relative;
    }

    #closeAbout {
      position: absolute;
      top: 10px;
      right: 10px;
      cursor: pointer;
      font-size: 1.2em;
      background: none;
      border: none;
      color: white;
    }

    .copy-button {
      background-color: #258BB0;
      color: white;
      border: none;
      padding: 0.5em;
      cursor: pointer;
      margin-top: 1em;
      margin-right: 0.5em;
    }

    .share-buttons {
      margin-top: 1em;
    }

    .share-buttons button {
      margin-right: 0.5em;
      background-color: #FF861C;
      color: white;
      border: none;
      padding: 0.5em;
      cursor: pointer;
    }


    .cool-blockquote {
      background: #f9f9ff;
      /*border-left: 6px solid #6c63ff;*/
      margin: 2em auto;
      padding: 1.5em 2em;
      font-size: 1.2em;
      font-style: italic;
      color: #333;
      border-radius: 10px;
      box-shadow: 0 4px 16px rgba(108, 99, 255, 0.08);
      max-width: 800px;
    }
    .cool-blockquote::before {
      content: "“";
      font-size: 2.5em;
      color: #6c63ff;
      vertical-align: 0em;
      margin-right: 0.1em;
    }
    .cool-blockquote::after {
      content: "”";
      font-size: 2.5em;
      color: #6c63ff;
      vertical-align: -0.6em;
      margin-left: 0.1em;
    }

    code{
      padding:5px;
      background-color: rgb(255, 235, 227);
      border-radius: 3px;
      /*box-shadow: 0 4px 16px rgba(108, 99, 255, 0.08);*/
    }

    section{
      background-color: ghostwhite;
      border: 1px solid lightgray;
      padding: 10px;
      margin-top: 10px;
    }

    .img-styled {
    border: 2px solid #ccc;         /* Light gray border */
    border-radius: 16px;            /* Rounded corners */
    box-shadow: 0 4px 16px rgba(0,0,0,0.15); /* Drop shadow */
}

  </style>
</head>
<body>
  <header>
    <img src="images/fellowship logo 1.png" alt="logo" height="80">
    <h1><span style="color: #FF861C;">open</span>EHR <span style="color: black;">- Fellowship 2025 Documentation</span></h1>
    <button id="aboutButton">About</button>
  </header>
  <main>
    <div class="sidebar" id="blogList">
      <h2>Blog Posts</h2>
    </div>
    <div class="content" id="mainContent">
      <h2>Welcome to my openEHR Fellowship Documentation!</h2>
      
      <p>
        I would like to welcome you to the documentation page for my project:
      </p>
      <strong>Development of an Open Source openEHR Archetype Exploration, Mapping and Planning Tool</strong> <em>(working title)</em>
      
      <p>
        Throughout my fellowship, I will be regularly updating this page with new information, videos, and blog posts to document the progress of my project.
      </p>
      
      <p>
        Feel free to browse the content and explore the resources available. Please note that the documentation may be updated over time.
      </p>
      <p>
        Select a blog post or video from the sidebars to view it.
      </p>
    </div>
    <div class="sidebar" id="videoList">
      <h2>Videos</h2>
    </div>
  </main>
  <div id="aboutOverlay">
    <div id="aboutContent">
      <button id="closeAbout">&times;</button>
      <h2>About</h2>
      <p>This page shares updates and media related to the openEHR 2025 fellowship program, including blogs and recorded content.</p>
      <p>The work documenbted here is a collaboration between openEHR and the CAtalan Healthcare Service Catsalut.</p>

      <p>The information and materials provided on this website are for general informational purposes only. No guarantee is made regarding the completeness, accuracy, or reliability of the content. All content is provided “as is” without any warranties of any kind, either express or implied. Use of the information is at your own risk. </p>

      <p>© 2025, Martin A. Koch, CatSalut</p>
      
      <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; padding: 20px 0;">
        <img src="images/openehr_logo.png" alt="Left Logo" style="height: 40px; background-color: white; padding: 10px; border-radius: 5px;">
        <img src="images/gencat_logo.png" alt="Right Logo" style="height: 40px; background-color: white; padding: 10px; border-radius: 5px;">
      </div>




    </div>
  </div>

  <script>
    const blogsFolder = 'blogs';
    const videosFolder = 'videos';

    async function loadBlogTitles() {
      const response = await fetch(blogsFolder + '/index.json');
      const blogs = await response.json();
      const blogList = document.getElementById('blogList');
      blogs.forEach(blog => {
        const item = document.createElement('div');
        item.className = 'item';
        item.textContent = blog.title;
        item.onclick = () => {
          loadBlogPost(blog.file, blog.title);
          history.pushState(null, '', `?blog=${encodeURIComponent(blog.file)}`);
        };
        blogList.appendChild(item);
      });
    }

    function loadBlogPost(file, title) {
      fetch(`${blogsFolder}/${file}`)
        .then(res => res.text())
        .then(html => {
          const link = `${location.origin}${location.pathname}?blog=${encodeURIComponent(file)}`;
          document.getElementById('mainContent').innerHTML = `
            <!--<h2>${title}</h2>-->
            ${html}
            <div class="share-buttons">
              <button class="copy-button" onclick="copyToClipboard('${link}')">Copy Entry Link</button>
            </div>
          `;
        });
    }

    async function loadVideoTitles() {
      const response = await fetch(videosFolder + '/index.json');
      const videos = await response.json();
      const videoList = document.getElementById('videoList');
      videos.forEach(video => {
        const item = document.createElement('div');
        item.className = 'item';
        item.textContent = video.title;
        item.onclick = () => {
          loadVideo(video);
        };
        videoList.appendChild(item);
      });
    }

    function loadVideo(video) {
      //const videoUrl = `${location.origin}/${videosFolder}/${video.file}`;
      const videoUrl = `${videosFolder}/${video.file}`;
      const shareVideoUrl = `${location.origin}${location.pathname}/${videosFolder}/${video.file}`;
      const infoPath = `${videosFolder}/${video.info}`;
      document.getElementById('mainContent').innerHTML = `
        <h2>${video.title}</h2>
        <video controls controlsList="nodownload" width="100%">
          <source src="${videoUrl}" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <div class="share-buttons">
          <button class="copy-button" onclick="copyToClipboard('${shareVideoUrl}')">Copy Video Link</button>
        </div>
        <div id="videoInfo"></div>
      `;
      fetch(infoPath)
        .then(res => res.text())
        .then(html => {
          document.getElementById('videoInfo').innerHTML = html;
        });
    }

    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        alert('Link copied to clipboard!');
      });
    }

    function shareOn(platform, url, title = '') {
      let shareUrl = '';
      if (platform === 'twitter') {
        shareUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`;
      } else if (platform === 'facebook') {
        shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
      }
      window.open(shareUrl, '_blank');
    }

    document.getElementById('aboutButton').onclick = () => {
      document.getElementById('aboutOverlay').style.display = 'flex';
    };

    document.getElementById('closeAbout').onclick = () => {
      document.getElementById('aboutOverlay').style.display = 'none';
    };

    const urlParams = new URLSearchParams(window.location.search);
    const blogFile = urlParams.get('blog');

    loadBlogTitles();
    loadVideoTitles();

    if (blogFile) {
      fetch(blogsFolder + '/index.json')
        .then(res => res.json())
        .then(blogs => {
          const blog = blogs.find(b => b.file === blogFile);
          if (blog) loadBlogPost(blog.file, blog.title);
        });
    }
  </script>
</body>
</html>
